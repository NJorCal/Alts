import pytest
import sys
from os import path
# Add the alts directory to the Python path
sys.path.append(path.join(path.dirname(__file__), '..'))
from relatedness import relatedness_coefficient


@pytest.mark.parametrize('ancestry_1, ancestry_2, expected_relatedness', [
    ([[1000], [0, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [0, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0),
    ([[1000], [1, 2], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [1000, 1], [1, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.75),
    ([[1000], [1, 2], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [1, 2], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.5),
    ([[1000], [5, 6], [1, 2, 3, 4], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [5, 6], [1, 2, 3, 4], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.5),
    ([[1000], [2000, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [0, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.5),
    ([[1000], [0, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [1000, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.5),
    ([[1000], [1, 2], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [1, 3], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.25),
    ([[1000], [3, 0], [1, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [1, 2], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.25),
    ([[1000], [3, 4], [2000, 0, 0, 0], [1, 2, 0, 0, 0, 0, 0, 0]],
     [[2000], [1, 2], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.25),
    ([[1000], [3, 0], [1, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [4, 0], [1, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.125),
    ([[1000], [0, 0], [0, 0, 0, 0], [2000, 0, 0, 0, 0, 0, 0, 0]],
     [[2000], [0, 0], [0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]],
     0.125),
    ([[1000], [5, 0], [3, 0, 0, 0], [1, 2, 0, 0, 0, 0, 0, 0]],
     [[2000], [6, 0], [4, 0, 0, 0], [1, 2, 0, 0, 0, 0, 0, 0]],
     0.03125)
])
def test_relatedness(ancestry_1, ancestry_2, expected_relatedness):
    calculated_relatedness = relatedness_coefficient(ancestry_1, ancestry_2)
    assert calculated_relatedness == expected_relatedness
